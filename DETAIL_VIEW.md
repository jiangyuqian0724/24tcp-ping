# 详细历史查看功能说明

## 🎉 新功能

现在你可以点击每个监控卡片上的"查看详情"按钮，查看完整的历史数据和长期趋势图表！

## 📊 功能特性

### 1. **查看详情按钮**
每个监控卡片上都有一个📋图标按钮，点击即可打开详情弹窗。

### 2. **时间范围筛选**
支持以下时间范围：
- **全部** - 查看所有历史数据（不限100条）
- **最近1小时** - 最近60分钟的数据
- **最近6小时** - 最近6小时的数据
- **最近24小时** - 最近1天的数据
- **最近7天** - 最近7天的数据

### 3. **详细统计信息**
显示6个关键指标：
- 总检测次数
- 成功次数
- 失败次数
- 平均延迟
- 最小延迟
- 最大延迟

### 4. **长期趋势图表** ⭐ 新增
- 📈 大尺寸趋势图（400px高度）
- 🎨 渐变填充区域
- 📍 每个数据点标记
- 📊 自动缩放Y轴
- 🕐 时间轴标签
- 📝 实时统计信息显示

### 5. **完整历史记录表格**
- 📅 精确到秒的时间戳
- ✅ 成功/失败状态标记
- ⏱️ 每次检测的延迟
- ❌ 错误信息（如果有）
- 🔄 最新数据在最上方

## 🚀 使用方法

### 步骤1: 打开详情
1. 访问 http://localhost:8080
2. 找到任意监控卡片
3. 点击卡片右上角的📋"查看详情"按钮

### 步骤2: 选择时间范围
- 点击顶部的时间范围按钮
- 图表和表格会自动更新

### 步骤3: 查看数据
- **趋势图**: 查看延迟随时间的变化
- **统计卡片**: 查看汇总数据
- **历史表格**: 查看每次检测的详细记录

## 📈 图表说明

### 趋势图特性
- **蓝色渐变区域**: 延迟范围
- **蓝色线条**: 延迟趋势
- **绿色圆点**: 成功的检测点
- **Y轴**: 延迟（毫秒）
- **X轴**: 时间（自动格式化）
- **顶部标题**: 显示数据点数量
- **右上角**: 显示平均/最小/最大延迟

### 自动缩放
- Y轴根据实际延迟范围自动调整
- 确保所有数据点都清晰可见
- 网格线帮助读取数值

## 🔍 数据查看示例

### 查看所有历史数据
```
1. 点击"查看详情"
2. 选择"全部"
3. 查看完整的516条记录（示例）
```

### 查看最近1小时
```
1. 点击"查看详情"
2. 选择"最近1小时"
3. 只显示最近60分钟的数据
```

### 分析延迟趋势
```
1. 查看趋势图
2. 观察延迟是否稳定
3. 识别延迟峰值时间
4. 在表格中查找具体时间点
```

## 📊 API接口

### 获取所有历史数据
```bash
curl http://localhost:8080/api/monitors/{id}/history
```

### 获取指定时间范围
```bash
# 最近1小时
curl http://localhost:8080/api/monitors/{id}/history?range=1h

# 最近6小时
curl http://localhost:8080/api/monitors/{id}/history?range=6h

# 最近24小时
curl http://localhost:8080/api/monitors/{id}/history?range=24h

# 最近7天
curl http://localhost:8080/api/monitors/{id}/history?range=7d
```

### 限制返回数量（可选）
```bash
# 只返回最近100条
curl http://localhost:8080/api/monitors/{id}/history?limit=100

# 结合时间范围和数量限制
curl http://localhost:8080/api/monitors/{id}/history?range=24h&limit=50
```

## 💡 使用技巧

### 1. 性能分析
- 使用"全部"查看长期趋势
- 识别性能下降的时间段
- 对比不同时间段的延迟

### 2. 故障排查
- 查看失败记录的错误信息
- 分析失败发生的时间模式
- 检查是否有周期性问题

### 3. 容量规划
- 查看历史最大延迟
- 评估服务稳定性
- 预测未来趋势

### 4. 报告生成
- 截图趋势图
- 导出统计数据
- 记录关键时间点

## 🎨 界面特点

### 现代化设计
- 深色主题
- 紫色渐变
- 流畅动画
- 响应式布局

### 交互体验
- 点击背景关闭弹窗
- 按ESC键关闭弹窗
- 时间范围按钮高亮
- 表格行悬停效果

## 📱 移动端支持

- 弹窗自适应屏幕
- 统计卡片2列布局
- 时间筛选按钮换行
- 表格横向滚动

## 🔒 数据安全

- 所有数据保存在本地
- 不会发送到外部服务器
- 支持数据备份
- 容器重启后保留

## 📝 数据限制

- 每个监控最多保存 **1000条** 历史记录
- 超过限制时自动删除最旧的记录
- 可在 `server.js` 中修改 `MAX_HISTORY` 常量

## 🎯 实际应用

### 监控网站可用性
```
目标: example.com:443
查看: 最近24小时
分析: 是否有宕机时间
```

### 监控数据库性能
```
目标: db.example.com:3306
查看: 最近7天
分析: 延迟是否增长
```

### 监控API响应
```
目标: api.example.com:443
查看: 全部
分析: 长期性能趋势
```

## 🚀 快速测试

```bash
# 1. 访问界面
http://localhost:8080

# 2. 点击任意监控的"查看详情"按钮

# 3. 尝试不同的时间范围

# 4. 查看趋势图和历史表格
```

## ✨ 总结

现在你可以：
- ✅ 查看**所有**历史数据（不限100条）
- ✅ 查看**长期趋势图表**
- ✅ 按**时间范围**筛选数据
- ✅ 查看**详细统计**信息
- ✅ 分析**延迟变化**趋势
- ✅ 识别**性能问题**

**享受全新的数据分析体验！** 🎉
